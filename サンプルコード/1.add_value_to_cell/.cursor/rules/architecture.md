### `architecture.md` 

# 1\. はじめに (概要)

## 1.1. このプログラムの目的

`docs/test1.xlsx` というExcelファイルに含まれる `housui` シートと `aristo` シートからそれぞれ数値データを読み取り、`downloads/summary.xlsx` という別のExcelファイルの特定のセルに、それらの数値を**加算**していく。

## 1.2. 設計の考え方

  * **単一ファイル構成**: プログラムのすべてのコードは `main.py` という一つのファイルに記述し、全体像を把握しやすくする。
  * **役割分担**: `main.py` の前半で再利用可能な部品（関数）を定義し、後半でその部品を使って具体的な処理を実行する。

# 2\. ファイル構成

プログラム全体は、以下のファイルとフォルダで構成される。

```
.
├── docs/                     # 入力データを入れておくフォルダ
|   └── test1.xlsx          # 元データ(housui, aristoシート入り)
|
├── downloads/                # 出力結果を保存するフォルダ
|   └── summary.xlsx          # (プログラムが自動で作成・更新するファイル)
|
└── main.py                 # プログラムのコードをすべて記述するファイル
```

# 3\. `main.py` の設計

`main.py` の中身は、\*\*前半の「関数定義」**と**後半の「メイン処理」\*\*の2つのパートに分かれる。

-----

## 3.1. 前半：関数の定義 `add_value_to_cell`

`main.py` ファイルの最初に、Excelのセルに値を加算するための部品（関数）を用意する。

  * **関数名**: `add_value_to_cell`
  * **役割**: 指定されたExcelセルの現在の値に、新しい数値を足し算して上書き保存する。
  * **引数**:
      * `file_path` (文字列): 操作するExcelファイルのパス (例: `"downloads/summary.xlsx"`)
      * `sheet_name` (文字列): 操作するシート名 (例: `"Results"`)
      * `cell` (文字列): セル番地 (例: `"B2"`)
      * `value` (数値): 加算したい数値 (例: `100`)
  * **処理の流れ**:
    1.  指定された `file_path` を開く。（ファイルがなければ新規作成する）
    2.  指定された `sheet_name` を選択する。（シートがなければ新規作成する）
    3.  指定された `cell` の値を取得する。
    4.  もしセルが空(`None`)なら、値を `0` として扱う。
    5.  現在の値と引数 `value` を足し算する。
    6.  計算結果を同じセルに書き戻す。
    7.  ファイルを保存する。

-----

## 3.2. 後半：メイン処理

関数を定義した後、`main.py` に続けて、プログラムの本体となる処理を記述する。

  * **役割**: `add_value_to_cell` 関数を実際に呼び出し、データ集計を順番に行う。
  * **処理の流れ**:
    1.  **準備 (データ読み込み)**:

          * `docs/test1.xlsx` の `housui` シートから集計したい値（例: `C2`セルの値）を読み込む。
          * `docs/test1.xlsx` の `aristo` シートから集計したい値（例: `C2`セルの値）を読み込む。

    2.  **ホウスイの値を集計ファイルに加算**:

          * `add_value_to_cell` 関数を以下の情報で呼び出す。
              * `file_path`: `"downloads/summary.xlsx"`
              * `sheet_name`: `"Results"`
              * `cell`: `"B2"` （ホウスイの集計用セル）
              * `value`: `housui` シートから読み込んだ値

    3.  **アリストの値を集計ファイルに加算**:

          * `add_value_to_cell` 関数を以下の情報で呼び出す。
              * `file_path`: `"downloads/summary.xlsx"`
              * `sheet_name`: `"Results"`
              * `cell`: `"B3"` （アリストの集計用セル）
              * `value`: `aristo` シートから読み込んだ値

    4.  **完了報告**:

          * すべての処理が終わったら、画面に「集計処理が完了しました。」と表示する。

