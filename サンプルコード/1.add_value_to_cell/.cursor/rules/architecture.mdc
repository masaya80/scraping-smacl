---
alwaysApply: true
---
### `architecture.md` 

# 1\. はじめに (概要)

## 1.1. このプログラムの目的

**コマンドライン引数**で指定されたホウスイシート名を受け取り、**標準入力**でターミナルから入力された数値を、`docs/test1.xlsx` の `アリスト` シートの特定のセルに**加算**する。

## 1.2. 設計の考え方

  * **単一ファイル構成**: プログラムのすべてのコードは `main.py` という一つのファイルに記述し、全体像を把握しやすくする。
  * **役割分担**: `main.py` の前半で再利用可能な部品（関数）を定義し、後半でその部品を使って具体的な処理を実行する。
  * **引数処理**: `sys.argv` を使ってコマンドライン引数を処理する。
  * **対話型入力**: `input()` 関数を使って標準入力から数値を受け取る。

# 2\. ファイル構成

プログラム全体は、以下のファイルとフォルダで構成される。

```
.
├── docs/                     # 入力データを入れておくフォルダ
|   └── test1.xlsx          # 元データ(ホウスイ, アリストシート入り)
|
└── main.py                 # プログラムのコードをすべて記述するファイル
```

# 3\. `main.py` の設計

`main.py` の中身は、\*\*前半の「関数定義」**と**後半の「メイン処理」\*\*の2つのパートに分かれる。

-----

## 3.1. 前半：関数の定義 `add_value_to_cell`

`main.py` ファイルの最初に、Excelのセルに値を加算するための部品（関数）を用意する。

  * **関数名**: `add_value_to_cell`
  * **役割**: 指定されたExcelセルの現在の値に、新しい数値を足し算して上書き保存する。
  * **引数**:
      * `file_path` (文字列): 操作するExcelファイルのパス (例: `"downloads/summary.xlsx"`)
      * `sheet_name` (文字列): 操作するシート名 (例: `"Results"`)
      * `cell` (文字列): セル番地 (例: `"B2"`)
      * `value` (数値): 加算したい数値 (例: `100`)
  * **処理の流れ**:
    1.  指定された `file_path` を開く。（ファイルがなければ新規作成する）
    2.  指定された `sheet_name` を選択する。（シートがなければ新規作成する）
    3.  指定された `cell` の値を取得する。
    4.  もしセルが空(`None`)なら、値を `0` として扱う。
    5.  現在の値と引数 `value` を足し算する。
    6.  計算結果を同じセルに書き戻す。
    7.  ファイルを保存する。

-----

## 3.2. 後半：メイン処理

関数を定義した後、`main.py` に続けて、プログラムの本体となる処理を記述する。

  * **役割**: コマンドライン引数と標準入力を処理し、`add_value_to_cell` 関数を呼び出してデータを加算する。
  * **処理の流れ**:
    1.  **引数チェック**:

          * `sys.argv` を使ってコマンドライン引数を確認する。
          * 引数が不足している場合は使用方法を表示して終了する。
          * 使用例: `python3 main.py ホウスイ`

    2.  **ホウスイシート名の取得**:

          * 第1引数からホウスイシート名を取得する。
          * 指定されたシートが存在するかチェックする。

    3.  **標準入力からの数値取得**:

          * `input()` 関数を使ってユーザーから数値を入力してもらう。
          * 入力値が数値として正しいかバリデーションする。

    4.  **アリストシートへの加算**:

          * `add_value_to_cell` 関数を以下の情報で呼び出す。
              * `file_path`: `"docs/test1.xlsx"`
              * `sheet_name`: `"アリスト"`
              * `cell`: `"C2"` （加算対象のセル）
              * `value`: 標準入力から取得した数値

    5.  **完了報告**:

          * すべての処理が終わったら、「{ホウスイシート名}の数値をアリストシートに加算しました。」と表示する。

